/**
 * mpxjs webview bridge v2.8.1
 * (c) 2023 @mpxjs team
 * @license Apache
 */
/**
 * mpxjs webview bridge v2.8.1
 * (c) 2023 @mpxjs team
 * @license Apache
 */
const e={wx:{url:"https://res.wx.qq.com/open/js/jweixin-1.3.2.js"},qq:{url:"https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js"},ali:{url:"https://appx/web-view.min.js"},baidu:{url:"https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.4.js"},tt:{url:"https://s3.pstatp.com/toutiao/tmajssdk/jssdk.js"},...window.sdkUrlMap};let o=null,a=0;const t={},n=navigator.userAgent;n.indexOf("AlipayClient")>-1?o="my":n.toLowerCase().indexOf("miniprogram")>-1?o=n.indexOf("QQ")>-1?"qq":"wx":n.indexOf("swan")>-1?o="swan":n.indexOf("toutiao")>-1?o="tt":(o="web",window.addEventListener("message",e=>{e.data.isMpxWebview&&(o="web",window.parent.postMessage({type:"load",detail:{load:!0}},"*"));const{callbackId:a,error:n,result:i}=e.data;void 0!==a&&t[a]&&(n?t[a](n):t[a](null,i),delete t[a])},!1));const i={config(e){if("wx"===o){if(window.wx){if(!e)return void console.log("\u5fae\u4fe1\u73af\u5883\u4e0b\u9700\u8981\u914d\u7f6ewx.config\u624d\u80fd\u6302\u8f7d\u65b9\u6cd5");window.wx.config(e)}}else console.log("\u975e\u5fae\u4fe1\u73af\u5883\u4e0d\u9700\u8981\u914d\u7f6econfig")}};function s(e){if("[object Object]"!==Object.prototype.toString.call(e))return e;const o={};for(const a in e)"function"!=typeof e[a]&&(o[a]=e[a]);return o}const r=e=>{const n={wx:{keyName:"miniProgram",api:["navigateTo","navigateBack","switchTab","reLaunch","redirectTo","postMessage","getEnv"]},tt:{keyName:"miniProgram",api:["redirectTo","navigateTo","switchTab","reLaunch","navigateBack","setSwipeBackModeSync","postMessage","getEnv","checkJsApi","chooseImage","compressImage","previewImage","uploadFile","getNetworkType","openLocation","getLocation"]},swan:{keyName:"webView",api:["navigateTo","navigateBack","switchTab","reLaunch","redirectTo","getEnv","postMessage"]},qq:{keyName:"miniProgram",api:["navigateTo","navigateBack","switchTab","reLaunch","redirectTo","getEnv","postMessage"]}}[o]||{},r={wx:["checkJSApi","chooseImage","previewImage","uploadImage","downloadImage","getLocalImgData","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","translateVoice","getNetworkType","openLocation","getLocation","startSearchBeacons","stopSearchBeacons","onSearchBeacons","scanQRCode","chooseCard","addCard","openCard"],my:["navigateTo","navigateBack","switchTab","reLaunch","redirectTo","chooseImage","previewImage","getLocation","openLocation","alert","showLoading","hideLoading","getNetworkType","startShare","tradePay","postMessage","onMessage","getEnv"],swan:["makePhoneCall","setClipboardData","getNetworkType","openLocation","getLocation","chooseLocation","chooseImage","previewImage","openShare","navigateToSmartProgram"],web:["navigateTo","navigateBack","switchTab","reLaunch","redirectTo","getEnv","postMessage","getLoadError","getLocation"]}[o]||{};(n.api||[]).forEach(a=>{i[a]=(...t)=>e.then(()=>{window[o][n.keyName][a](...t)})}),r.forEach(n=>{i[n]=(...i)=>"web"===o?function(e,o){if("getEnv"!==e){const n=++a;t[n]=(e,a)=>{e?(o.fail&&o.fail(e),o.complete&&o.complete(e)):(o.success&&o.success(a),o.complete&&o.complete(a)),delete t[n]},window.parent.postMessage&&window.parent.postMessage({type:e,callbackId:a,detail:{data:s(o)}},"*")}else o({miniprogram:!1})}(n,...i):e.then(()=>{window[o][n](...i)})})};(()=>{if(null===o)return console.log("mpxjs/webview: \u672a\u8bc6\u522b\u7684\u73af\u5883\uff0c\u5f53\u524d\u4ec5\u652f\u6301 \u5fae\u4fe1\u3001\u652f\u4ed8\u5b9d\u3001\u767e\u5ea6\u3001\u5934\u6761 QQ \u5c0f\u7a0b\u5e8f"),void r();const a=window[o]||"web"===o?Promise.resolve():e[o].url?function(e,{time:o=5e3,crossOrigin:a=!1}={}){return Promise.race([new Promise((o,t)=>{const n=document.createElement("script");n.type="text/javascript",n.async="async",a&&(n.crossOrigin="anonymous"),n.onload=n.onreadystatechange=function(){this.readyState&&!/^(loaded|complete)$/.test(this.readyState)||(o(),n.onload=n.onreadystatechange=null)},n.onerror=function(){t(new Error(`load ${e} error`)),n.onerror=null},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}),new Promise((a,t)=>{setTimeout(()=>{t(new Error(`load ${e} timeout`))},o)})])}(e[o].url,{crossOrigin:!!e[o].crossOrigin}):Promise.reject(new Error("\u672a\u627e\u5230\u5bf9\u5e94\u7684sdk"));r(a)})();export default i;